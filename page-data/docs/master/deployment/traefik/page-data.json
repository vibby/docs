{"componentChunkName":"component---src-templates-doc-js","path":"/docs/master/deployment/traefik/","result":{"pageContext":{"html":"<h1 id=\"implement-træfik-into-api-platform-dockerized\" style=\"position:relative;\"><a href=\"#implement-tr%C3%A6fik-into-api-platform-dockerized\" aria-label=\"implement træfik into api platform dockerized permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Implement Træfik Into API Platform Dockerized</h1>\n<blockquote>\n<p>An open-source reverse proxy and load balancer for HTTP and TCP-based applications that is easy, dynamic, automatic, fast, full-featured, production proven, provides metrics and integrates with every major cluster technology.</p>\n<p>—<a href=\"https://traefik.io\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://traefik.io</a></p>\n</blockquote>\n<h2 id=\"basic-implementation\" style=\"position:relative;\"><a href=\"#basic-implementation\" aria-label=\"basic implementation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Basic Implementation</h2>\n<p>This tutorial will help you to define your own routes for your client, api and more generally for your containers.</p>\n<p>Use this custom API Platform <code class=\"language-text\">docker-compose.yml</code> file which implements ready-to-use Træfik container configuration. Override\nports and add labels to tell Træfik to listen on the routes mentioned and redirect routes to a specified container.</p>\n<p>A few points to note:</p>\n<ul>\n<li><code class=\"language-text\">--api.insecure=true</code> Tells Træfik to generate a browser view to watch containers and IP/DNS associated easier  </li>\n<li><code class=\"language-text\">--providers.docker</code> Tells Træfik to listen on Docker Api  </li>\n<li>\n<p><code class=\"language-text\">labels:</code> Key for Træfik configuration into Docker integration</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n<span class=\"token comment\">#  ...</span>\n<span class=\"token key atrule\">api</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> traefik.http.routers.api.rule=Host(`api.localhost`)</code></pre></div>\n<p>The API DNS will be specified with <code class=\"language-text\">traefik.http.routers.api.rule=Host(`your.host`)</code> (here api.localhost)</p>\n</li>\n<li><code class=\"language-text\">--traefik.routers.clientloadbalancer.server.port=3000</code> The port specified to Træfik will be exposed by the container (here the React app exposes the 3000 port), but if your container exposes only one port, it can be ignored</li>\n</ul>\n<p>We assume that you've generated a SSL <code class=\"language-text\">localhost.crt</code> and associated <code class=\"language-text\">localhost.key</code> combo under <code class=\"language-text\">./certs</code> folder\nThen you edited your <code class=\"language-text\">admin/Dockerfile</code> and <code class=\"language-text\">client/Dockerfile</code> like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span><span class=\"token line\">ENV HTTPS true\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">EXPOSE 3000</span></span></code></pre></div>\n<p>After that, don't forget to re-build your containers</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># docker-compose.yml</span>\n<span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'3.4'</span>\n\n<span class=\"token key atrule\">x-cache-from</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> <span class=\"token important\">&amp;cache</span>\n    <span class=\"token key atrule\">cache_from</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>NGINX_IMAGE<span class=\"token punctuation\">:</span><span class=\"token punctuation\">-</span>quay.io/api<span class=\"token punctuation\">-</span>platform/nginx<span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>PHP_IMAGE<span class=\"token punctuation\">:</span><span class=\"token punctuation\">-</span>quay.io/api<span class=\"token punctuation\">-</span>platform/php<span class=\"token punctuation\">}</span>\n\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">traefik</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> traefik<span class=\"token punctuation\">:</span>latest\n      <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>api.insecure=true <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>providers.docker\n      <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n          <span class=\"token key atrule\">published</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n          <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> tcp\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> <span class=\"token number\">443</span>\n          <span class=\"token key atrule\">published</span><span class=\"token punctuation\">:</span> <span class=\"token number\">443</span>\n          <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> tcp\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> <span class=\"token number\">8080</span>\n          <span class=\"token key atrule\">published</span><span class=\"token punctuation\">:</span> <span class=\"token number\">8080</span>\n          <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> tcp\n      <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> /var/run/docker.sock<span class=\"token punctuation\">:</span>/var/run/docker.sock\n\n  <span class=\"token key atrule\">php</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">context</span><span class=\"token punctuation\">:</span> ./api\n      <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> api_platform_php\n      <span class=\"token key atrule\">&lt;&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token important\">*cache</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>PHP_IMAGE<span class=\"token punctuation\">:</span><span class=\"token punctuation\">-</span>quay.io/api<span class=\"token punctuation\">-</span>platform/php<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">healthcheck</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">interval</span><span class=\"token punctuation\">:</span> 10s\n      <span class=\"token key atrule\">timeout</span><span class=\"token punctuation\">:</span> 3s\n      <span class=\"token key atrule\">retries</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span>\n      <span class=\"token key atrule\">start_period</span><span class=\"token punctuation\">:</span> 30s\n    <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> db\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./api<span class=\"token punctuation\">:</span>/srv/api<span class=\"token punctuation\">:</span>rw<span class=\"token punctuation\">,</span>cached\n      <span class=\"token punctuation\">-</span> ./api/docker/php/conf.d/api<span class=\"token punctuation\">-</span>platform.dev.ini<span class=\"token punctuation\">:</span>/usr/local/etc/php/conf.d/api<span class=\"token punctuation\">-</span>platform.ini\n\n  <span class=\"token key atrule\">api</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">context</span><span class=\"token punctuation\">:</span> ./api\n      <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> api_platform_nginx\n      <span class=\"token key atrule\">&lt;&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token important\">*cache</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>NGINX_IMAGE<span class=\"token punctuation\">:</span><span class=\"token punctuation\">-</span>quay.io/api<span class=\"token punctuation\">-</span>platform/nginx<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> php\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./api/public<span class=\"token punctuation\">:</span>/srv/api/public<span class=\"token punctuation\">:</span>ro\n\n  <span class=\"token key atrule\">vulcain</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> dunglas/vulcain\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> CERT_FILE=/certs/localhost.crt\n      <span class=\"token punctuation\">-</span> KEY_FILE=/certs/localhost.key\n      <span class=\"token punctuation\">-</span> UPSTREAM=http<span class=\"token punctuation\">:</span>//api\n    <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> api\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./certs<span class=\"token punctuation\">:</span>/certs<span class=\"token punctuation\">:</span>ro\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> traefik.http.routers.vulcain.rule=Host(`vulcain.localhost`)\n\n  <span class=\"token key atrule\">db</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> postgres<span class=\"token punctuation\">:</span>12<span class=\"token punctuation\">-</span>alpine\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> POSTGRES_DB=api\n      <span class=\"token punctuation\">-</span> POSTGRES_PASSWORD=<span class=\"token tag\">!ChangeMe</span><span class=\"token tag\">!</span>\n      <span class=\"token punctuation\">-</span> POSTGRES_USER=api<span class=\"token punctuation\">-</span>platform\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> db<span class=\"token punctuation\">-</span>data<span class=\"token punctuation\">:</span>/var/lib/postgresql/data<span class=\"token punctuation\">:</span>rw\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> traefik.http.routers.db.rule=Host(`db.localhost`)\n\n  <span class=\"token key atrule\">mercure</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> dunglas/mercure\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n<span class=\"token comment\">#      - ACME_HOSTS=${DOMAIN_NAME}</span>\n<span class=\"token comment\">#      - CERT_FILE=/certs/localhost.crt</span>\n<span class=\"token comment\">#      - KEY_FILE=/certs/localhost.key</span>\n      <span class=\"token punctuation\">-</span> JWT_KEY=$<span class=\"token punctuation\">{</span>JWT_KEY<span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">-</span> ALLOW_ANONYMOUS=1\n      <span class=\"token punctuation\">-</span> USE_FORWARDED_HEADERS=true\n      <span class=\"token punctuation\">-</span> CORS_ALLOWED_ORIGINS=*\n      <span class=\"token punctuation\">-</span> READ_TIMEOUT=0s\n      <span class=\"token punctuation\">-</span> WRITE_TIMEOUT=0s\n      <span class=\"token punctuation\">-</span> PUBLISH_ALLOWED_ORIGINS=*\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./certs<span class=\"token punctuation\">:</span>/certs<span class=\"token punctuation\">:</span>ro\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> traefik.http.routers.mercure.rule=Host(`mercure.localhost`)\n\n  <span class=\"token key atrule\">client</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">context</span><span class=\"token punctuation\">:</span> ./client\n      <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> api_platform_client_development\n      <span class=\"token key atrule\">cache_from</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>CLIENT_IMAGE<span class=\"token punctuation\">:</span><span class=\"token punctuation\">-</span>quay.io/api<span class=\"token punctuation\">-</span>platform/client<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>CLIENT_IMAGE<span class=\"token punctuation\">:</span><span class=\"token punctuation\">-</span>quay.io/api<span class=\"token punctuation\">-</span>platform/client<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">tty</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> API_PLATFORM_CLIENT_GENERATOR_ENTRYPOINT=http<span class=\"token punctuation\">:</span>//api\n      <span class=\"token punctuation\">-</span> API_PLATFORM_CLIENT_GENERATOR_OUTPUT=src\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./client<span class=\"token punctuation\">:</span>/usr/src/client<span class=\"token punctuation\">:</span>rw<span class=\"token punctuation\">,</span>cached\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> traefik.http.routers.client.rule=Host(`client.localhost`)\n      <span class=\"token punctuation\">-</span> traefik.http.services.client.loadbalancer.server.port=3000\n\n  <span class=\"token key atrule\">admin</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">context</span><span class=\"token punctuation\">:</span> ./admin\n      <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> api_platform_admin_development\n      <span class=\"token key atrule\">cache_from</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>ADMIN_IMAGE<span class=\"token punctuation\">:</span><span class=\"token punctuation\">-</span>quay.io/api<span class=\"token punctuation\">-</span>platform/admin<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>ADMIN_IMAGE<span class=\"token punctuation\">:</span><span class=\"token punctuation\">-</span>quay.io/api<span class=\"token punctuation\">-</span>platform/admin<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">tty</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./admin<span class=\"token punctuation\">:</span>/usr/src/admin<span class=\"token punctuation\">:</span>rw<span class=\"token punctuation\">,</span>cached\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> traefik.http.routers.admin.rule=Host(`admin.localhost`)\n      <span class=\"token punctuation\">-</span> traefik.http.services.admin.loadbalancer.server.port=3000\n\n<span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">db-data</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>Don't forget the db-data, or the database won't work in this dockerized solution.</p>\n<p><code class=\"language-text\">localhost</code> is a reserved domain referred to in your <code class=\"language-text\">/etc/hosts</code>.\nIf you want to implement custom DNS such as production DNS in local, just add them at the end of your <code class=\"language-text\">/etc/host</code> file like that: </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># /etc/hosts\n# ...\n\n127.0.0.1       your.domain.com</code></pre></div>\n<p>If you do that, you'll have to update the <code class=\"language-text\">CORS_ALLOW_ORIGIN</code> environment variable <code class=\"language-text\">api/.env</code> to accept the specified URL.</p>\n<h2 id=\"known-issues\" style=\"position:relative;\"><a href=\"#known-issues\" aria-label=\"known issues permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Known Issues</h2>\n<p>If your network is of type B, it may conflict with the Træfik sub-network.</p>\n<h2 id=\"going-further\" style=\"position:relative;\"><a href=\"#going-further\" aria-label=\"going further permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Going Further</h2>\n<p>As this Træfik configuration listens on 80 and 443 ports, you can run only 1 Træfik instance per server. However, you may want to run multiple API Platform projects on the same server. To deal with it, you'll have to externalize the Træfik configuration to another <code class=\"language-text\">docker-compose.yml</code> file, anywhere on your server.</p>\n<p>Here is a working example:</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># /somewhere/docker-compose.yml</span>\n<span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'3.4'</span>\n\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">traefik</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> traefik<span class=\"token punctuation\">:</span>latest\n    <span class=\"token key atrule\">command</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>api.insecure=true <span class=\"token punctuation\">-</span><span class=\"token punctuation\">-</span>providers.docker\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n        <span class=\"token key atrule\">published</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n        <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> tcp\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> <span class=\"token number\">443</span>\n        <span class=\"token key atrule\">published</span><span class=\"token punctuation\">:</span> <span class=\"token number\">443</span>\n        <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> tcp\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> <span class=\"token number\">8080</span>\n        <span class=\"token key atrule\">published</span><span class=\"token punctuation\">:</span> <span class=\"token number\">8080</span>\n        <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> tcp\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> /var/run/docker.sock<span class=\"token punctuation\">:</span>/var/run/docker.sock\n    <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> api_platform_network\n    <span class=\"token comment\"># Add other networks here</span>\n\n<span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">api_platform_network</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">external</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n  <span class=\"token comment\"># Add other networks here</span></code></pre></div>\n<p>Then update the <code class=\"language-text\">docker-compose.yml</code> file belonging to your API Platform projects:</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"># /anywhere/api-platform/docker-compose.yml\nversion: '3.4'\n\nx-cache:\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\"> &amp;cache\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\"> cache_from:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   - ${CONTAINER_REGISTRY_BASE}/php\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   - ${CONTAINER_REGISTRY_BASE}/nginx\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   - ${CONTAINER_REGISTRY_BASE}/varnish\n</span></span>\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">x-network:\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\">  &amp;network\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\">  networks:\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\">    - api_platform_network\n</span></span>\nservices:\n<span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span><span class=\"token line\">  traefik:\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">    image: traefik:latest\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">    command: --api.insecure=true --providers.docker\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">    ports:\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">      - target: 80\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">        published: 80\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">        protocol: tcp\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">      - target: 443\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">        published: 443\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">        protocol: tcp\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">      - target: 8080\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">        published: 8080\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">        protocol: tcp\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">    volumes:\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">      - /var/run/docker.sock:/var/run/docker.sock\n</span></span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\"> php:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   build:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     context: ./api\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     target: api_platform_php\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     &lt;&lt;: *cache\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   image: ${PHP_IMAGE:-quay.io/api-platform/php}\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">    environment:\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\">      # You should remove these variables from .env into api folder\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\">      - TRUSTED_HOSTS=^(((${SUBDOMAINS_LIST}\\.)?${DOMAIN_NAME})|api)$$\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\">      - CORS_ALLOW_ORIGIN=^${HTTP_OR_SSL}(${SUBDOMAINS_LIST}.)?${DOMAIN_NAME}$$\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\">      - DATABASE_URL=postgres://${DB_USER}:${DB_PASS}@db/${DB_NAME}\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\">      - MERCURE_SUBSCRIBE_URL=${HTTP_OR_SSL}mercure.${DOMAIN_NAME}$$\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\">      - MERCURE_PUBLISH_URL=${HTTP_OR_SSL}mercure.${DOMAIN_NAME}$$\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\">      - MERCURE_JWT_TOKEN=${JWT_KEY}\n</span></span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   healthcheck:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     interval: 10s\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     timeout: 3s\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     retries: 3\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     start_period: 30s\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   depends_on:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - db\n</span></span><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span><span class=\"token line\">      - dev-tls\n</span></span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   volumes:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - ./api:/srv/api:rw,cached\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - ./api/docker/php/conf.d/api-platform.dev.ini:/usr/local/etc/php/conf.d/api-platform.ini\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - ./certs:/certs:ro\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">    &lt;&lt;: *network\n</span></span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\"> api:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   build:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     context: ./api\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     target: api_platform_nginx\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     &lt;&lt;: *cache\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   image: ${NGINX_IMAGE:-quay.io/api-platform/nginx}\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   depends_on:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - php\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   volumes:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - ./api/public:/srv/api/public:ro\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   labels:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - traefik.http.routers.api.rule=Host(`api.${DOMAIN_NAME}`)\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">    &lt;&lt;: *network\n</span></span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\"> vulcain:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   image: dunglas/vulcain\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   environment:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - CERT_FILE=/certs/localhost.crt\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - KEY_FILE=/certs/localhost.key\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - UPSTREAM=http://api\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   depends_on:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - api\n</span></span><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span><span class=\"token line\">      - dev-tls\n</span></span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   volumes:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - ./certs:/certs:ro\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   labels:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - traefik.http.routers.vulcain.rule=Host(`vulcain.${DOMAIN_NAME}`)\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">    &lt;&lt;: *network\n</span></span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\"> db:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   image: postgres:12-alpine\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   environment:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - POSTGRES_DB=${DB_NAME}\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - POSTGRES_PASSWORD=${DB_PASS}\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - POSTGRES_USER=${DB_USER}\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   volumes:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - db-data:/var/lib/postgresql/data:rw\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   labels:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - traefik.http.routers.db.rule=Host(`db.${DOMAIN_NAME}`)\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">    &lt;&lt;: *network\n</span></span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\"> mercure:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   image: dunglas/mercure\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   environment:\n</span></span>#      - ACME_HOSTS=${DOMAIN_NAME}\n#      - CERT_FILE=/certs/localhost.crt\n#      - KEY_FILE=/certs/localhost.key\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - JWT_KEY=${JWT_KEY}\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - ALLOW_ANONYMOUS=1\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - USE_FORWARDED_HEADERS=true\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - CORS_ALLOWED_ORIGINS=*\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - READ_TIMEOUT=0s\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - WRITE_TIMEOUT=0s\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - PUBLISH_ALLOWED_ORIGINS=*\n</span></span><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span><span class=\"token line\">    depends_on:\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">      - dev-tls\n</span></span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   volumes:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - ./certs:/certs:ro\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   labels:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - traefik.http.routers.mercure.rule=Host(`mercure.${DOMAIN_NAME}`)\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">    &lt;&lt;: *network\n</span></span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\"> client:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   build:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     context: ./client\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     target: api_platform_client_development\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     cache_from:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">       - ${CLIENT_IMAGE:-quay.io/api-platform/client}\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   image: ${CLIENT_IMAGE:-quay.io/api-platform/client}\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   tty: true\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   environment:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - API_PLATFORM_CLIENT_GENERATOR_ENTRYPOINT=http://api\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - API_PLATFORM_CLIENT_GENERATOR_OUTPUT=src\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">      # You should remove this variable from .env into client folder\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\">      - REACT_APP_API_ENTRYPOINT=${HTTP_OR_SSL}api.${DOMAIN_NAME}\n</span></span><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span><span class=\"token line\">    depends_on:\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">      - dev-tls\n</span></span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   volumes:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - ./client:/usr/src/client:rw,cached\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   expose:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - 3000\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   labels:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - traefik.http.routers.client.rule=Host(`client.${DOMAIN_NAME}`)\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - traefik.http.services.client.loadbalancer.server.port=3000\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">    &lt;&lt;: *network\n</span></span>\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\"> admin:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   build:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     context: ./admin\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     target: api_platform_admin_development\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     cache_from:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">       - ${ADMIN_IMAGE:-quay.io/api-platform/admin}\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   image: ${ADMIN_IMAGE:-quay.io/api-platform/admin}\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   tty: true\n</span></span><span class=\"token deleted-sign deleted\"><span class=\"token prefix deleted\">-</span><span class=\"token line\">    depends_on:\n</span><span class=\"token prefix deleted\">-</span><span class=\"token line\">      - dev-tls\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">    environment:\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\">      # You should remove this variable from .env into client folder\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\">      - REACT_APP_API_ENTRYPOINT=${HTTP_OR_SSL}api.${DOMAIN_NAME}\n</span></span><span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   volumes:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - ./admin:/usr/src/admin:rw,cached\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   expose:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - 3000\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">   labels:\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - traefik.http.routers.admin.rule=Host(`admin.${DOMAIN_NAME}`)\n</span><span class=\"token prefix unchanged\"> </span><span class=\"token line\">     - traefik.http.services.admin.loadbalancer.server.port=3000\n</span></span><span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">    &lt;&lt;: *network\n</span></span>\nvolumes:\n<span class=\"token unchanged\"><span class=\"token prefix unchanged\"> </span><span class=\"token line\"> db-data: {}\n</span></span>\n<span class=\"token inserted-sign inserted\"><span class=\"token prefix inserted\">+</span><span class=\"token line\">networks:\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\">  api_platform_network:\n</span><span class=\"token prefix inserted\">+</span><span class=\"token line\">    external: true</span></span></code></pre></div>\n<p>Finally, some environment variables must be defined, here is an example of a <code class=\"language-text\">.env</code> file to set them: </p>\n<div class=\"gatsby-highlight\" data-language=\"dotenv\"><pre class=\"language-dotenv\"><code class=\"language-dotenv\">CONTAINER_REGISTRY_BASE=quay.io/api-platform\nDOMAIN_NAME=localhost\nHTTP_OR_SSL=https://\nDB_NAME=api-platform-db-name\nDB_PASS=YouMustChangeThisPassword\nDB_USER=api-platform\nJWT_KEY=!UnsecureChangeMe!\nSUBDOMAINS_LIST=(admin|api|mercure)</code></pre></div>\n<p>This way, you can configure your main variables into one single file.</p>\n<h2 id=\"multiple-instances\" style=\"position:relative;\"><a href=\"#multiple-instances\" aria-label=\"multiple instances permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Multiple Instances</h2>\n<p>If you want to run multiple API Platform instances on the same server and behind only one Træfik instance, you'll have to define different service names for each service to avoid named conflicts error since Træfik v2.0.<br>\nTo achieve that, by setting only one more environment variable, you'll be able to make each instance unique. Here is a working example below:</p>\n<div class=\"gatsby-highlight\" data-language=\"dotenv\"><pre class=\"language-dotenv\"><code class=\"language-dotenv\"># /anywhere/first/api-platform/.env\n#...\nRANDOM_UNIQUE_KEY=yourUniqueKeyForYourFirstInstance</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"dotenv\"><pre class=\"language-dotenv\"><code class=\"language-dotenv\"># /anywhere/second/api-platform/.env\n#...\nRANDOM_UNIQUE_KEY=yourUniqueKeyForYourSecondInstance</code></pre></div>\n<p>Then update each traefik http routers names and services following this sample for admin</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># /anywhere/first/api-plaform/docker-compose.yml</span>\n<span class=\"token comment\"># ...</span>\n    <span class=\"token key atrule\">labels</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> traefik.http.routers.admin<span class=\"token punctuation\">-</span>$<span class=\"token punctuation\">{</span>RANDOM_UNIQUE_KEY<span class=\"token punctuation\">}</span>.rule=Host(`admin.$<span class=\"token punctuation\">{</span>DOMAIN_NAME<span class=\"token punctuation\">}</span>`)\n      <span class=\"token punctuation\">-</span> traefik.http.services.admin<span class=\"token punctuation\">-</span>$<span class=\"token punctuation\">{</span>RANDOM_UNIQUE_KEY<span class=\"token punctuation\">}</span>.loadbalancer.server.port=3000</code></pre></div>\n<h2 id=\"more-generic-approach\" style=\"position:relative;\"><a href=\"#more-generic-approach\" aria-label=\"more generic approach permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>More Generic Approach</h2>\n<p>Here is a fully working sample for Træfik generic config with a little script using docker-compose override approach.<br>\nWe assume that you've set <code class=\"language-text\">EXPOSE 3000</code> in your client and admin Dockerfile.</p>\n<p>Create a new <code class=\"language-text\">init-dc.sh</code> which contains the generation code that will be written in <code class=\"language-text\">docker-compose.override.yaml</code> file.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/sh</span>\n<span class=\"token comment\"># /anywhere/api-platform/init-dc.sh</span>\n\n<span class=\"token assign-left variable\">services</span><span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"admin:admin.\"</span> <span class=\"token string\">\"api:api.\"</span> <span class=\"token string\">\"mercure:mercure.\"</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># Define your services keys following this format: \"{container key}:{sub DNS}\". To define root DNS write nothing after the colon</span>\n<span class=\"token assign-left variable\">text</span><span class=\"token operator\">=</span><span class=\"token string\">\"version: '3.4'\nservices:\"</span>\n\n<span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">k</span> <span class=\"token keyword\">in</span> <span class=\"token string\">\"<span class=\"token variable\">${services<span class=\"token punctuation\">[</span>@<span class=\"token punctuation\">]</span>}</span>\"</span> <span class=\"token punctuation\">;</span> <span class=\"token keyword\">do</span>\n    <span class=\"token assign-left variable\">key</span><span class=\"token operator\">=</span><span class=\"token variable\">${k<span class=\"token operator\">%%</span><span class=\"token operator\">:</span>*}</span>\n    <span class=\"token assign-left variable\">value</span><span class=\"token operator\">=</span><span class=\"token variable\">${k<span class=\"token operator\">#</span>*<span class=\"token operator\">:</span>}</span>\n    <span class=\"token assign-left variable\">text</span><span class=\"token operator\">+=</span><span class=\"token string\">\"\n  <span class=\"token variable\">$key</span>:\n    labels:\n      - traefik.http.routers.<span class=\"token variable\">$key</span>-\\<span class=\"token variable\">${RANDOM_UNIQUE_KEY}</span>.entrypoints=web-secure\n      - traefik.http.routers.<span class=\"token variable\">$key</span>-\\<span class=\"token variable\">${RANDOM_UNIQUE_KEY}</span>.rule=Host(\\<span class=\"token variable\"><span class=\"token variable\">`</span>$<span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">}</span><span class=\"token punctuation\">\\</span>$<span class=\"token punctuation\">{</span>DOMAIN_NAME<span class=\"token punctuation\">}</span><span class=\"token punctuation\">\\</span><span class=\"token variable\">`</span></span>)\n      - traefik.http.routers.<span class=\"token variable\">$key</span>-\\<span class=\"token variable\">${RANDOM_UNIQUE_KEY}</span>.tls=true\n      - traefik.http.routers.<span class=\"token variable\">$key</span>-\\<span class=\"token variable\">${RANDOM_UNIQUE_KEY}</span>.tls.domains[0].main=\\<span class=\"token variable\">${DOMAIN_NAME}</span>\n      - traefik.http.routers.<span class=\"token variable\">$key</span>-\\<span class=\"token variable\">${RANDOM_UNIQUE_KEY}</span>.tls.domains[0].sans=*.\\<span class=\"token variable\">${DOMAIN_NAME}</span>\n      - traefik.http.routers.<span class=\"token variable\">$key</span>-\\<span class=\"token variable\">${RANDOM_UNIQUE_KEY}</span>.tls.certresolver=sample\n\"</span>\n<span class=\"token keyword\">done</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"<span class=\"token variable\">$text</span>\"</span> <span class=\"token operator\">></span> ./docker-compose.override.yml</code></pre></div>\n<p>Write this minimal configuration into your <code class=\"language-text\">traefik.toml</code> file:</p>\n<div class=\"gatsby-highlight\" data-language=\"toml\"><pre class=\"language-toml\"><code class=\"language-toml\"><span class=\"token comment\"># /anywhere/traefik/traefik.toml</span>\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">providers.docker</span><span class=\"token punctuation\">]</span>\n  <span class=\"token key property\">endpoint</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"unix:///var/run/docker.sock\"</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">api</span><span class=\"token punctuation\">]</span>\n  <span class=\"token key property\">insecure</span> <span class=\"token punctuation\">=</span> <span class=\"token boolean\">true</span>\n  <span class=\"token key property\">dashboard</span> <span class=\"token punctuation\">=</span> <span class=\"token boolean\">true</span>\n  <span class=\"token key property\">debug</span> <span class=\"token punctuation\">=</span> <span class=\"token boolean\">true</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints.web</span><span class=\"token punctuation\">]</span>\n  <span class=\"token key property\">address</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\":80\"</span>\n  <span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints.web.http</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints.web.http.redirections</span><span class=\"token punctuation\">]</span>\n      <span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints.web.http.redirections.entryPoint</span><span class=\"token punctuation\">]</span>\n        <span class=\"token key property\">to</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"web-secure\"</span>\n        <span class=\"token key property\">scheme</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"https\"</span>\n\n<span class=\"token punctuation\">[</span><span class=\"token table class-name\">entryPoints.web-secure</span><span class=\"token punctuation\">]</span>\n  <span class=\"token key property\">address</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\":443\"</span></code></pre></div>\n<p>Then after that update respectively your API Platform and Træfik <code class=\"language-text\">docker-compose.yml</code> following these examples below.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># /anywhere/api-platform/docker-compose.yml</span>\n<span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'3.4'</span>\n\n<span class=\"token key atrule\">x-cache</span><span class=\"token punctuation\">:</span>\n  <span class=\"token important\">&amp;cache</span>\n  <span class=\"token key atrule\">cache_from</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>CONTAINER_REGISTRY_BASE<span class=\"token punctuation\">}</span>/php\n    <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>CONTAINER_REGISTRY_BASE<span class=\"token punctuation\">}</span>/nginx\n    <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>CONTAINER_REGISTRY_BASE<span class=\"token punctuation\">}</span>/varnish\n\n<span class=\"token key atrule\">x-network</span><span class=\"token punctuation\">:</span>\n  <span class=\"token important\">&amp;network</span>\n  <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> api_platform_network\n\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">php</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">context</span><span class=\"token punctuation\">:</span> ./api\n      <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> api_platform_php\n      <span class=\"token key atrule\">&lt;&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token important\">*cache</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>PHP_IMAGE<span class=\"token punctuation\">:</span><span class=\"token punctuation\">-</span>quay.io/api<span class=\"token punctuation\">-</span>platform/php<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token comment\"># You should remove these variables from .env into api folder</span>\n      <span class=\"token punctuation\">-</span> TRUSTED_HOSTS=^((($<span class=\"token punctuation\">{</span>SUBDOMAINS_LIST<span class=\"token punctuation\">}</span>\\.)<span class=\"token punctuation\">?</span>$<span class=\"token punctuation\">{</span>DOMAIN_NAME<span class=\"token punctuation\">}</span>)<span class=\"token punctuation\">|</span>api)$$\n      <span class=\"token punctuation\">-</span> CORS_ALLOW_ORIGIN=^$<span class=\"token punctuation\">{</span>HTTP_OR_SSL<span class=\"token punctuation\">}</span>($<span class=\"token punctuation\">{</span>SUBDOMAINS_LIST<span class=\"token punctuation\">}</span>.)<span class=\"token punctuation\">?</span>$<span class=\"token punctuation\">{</span>DOMAIN_NAME<span class=\"token punctuation\">}</span>$$\n      <span class=\"token punctuation\">-</span> DATABASE_URL=postgres<span class=\"token punctuation\">:</span>//$<span class=\"token punctuation\">{</span>DB_USER<span class=\"token punctuation\">}</span><span class=\"token punctuation\">:</span>$<span class=\"token punctuation\">{</span>DB_PASS<span class=\"token punctuation\">}</span>@db/$<span class=\"token punctuation\">{</span>DB_NAME<span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">-</span> MERCURE_SUBSCRIBE_URL=http<span class=\"token punctuation\">:</span>//mercure/.well<span class=\"token punctuation\">-</span>known/mercure\n      <span class=\"token punctuation\">-</span> MERCURE_PUBLISH_URL=http<span class=\"token punctuation\">:</span>//mercure/.well<span class=\"token punctuation\">-</span>known/mercure\n      <span class=\"token punctuation\">-</span> MERCURE_JWT_TOKEN=$<span class=\"token punctuation\">{</span>JWT_KEY<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">healthcheck</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">interval</span><span class=\"token punctuation\">:</span> 10s\n      <span class=\"token key atrule\">timeout</span><span class=\"token punctuation\">:</span> 3s\n      <span class=\"token key atrule\">retries</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span>\n      <span class=\"token key atrule\">start_period</span><span class=\"token punctuation\">:</span> 30s\n    <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> db\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./api<span class=\"token punctuation\">:</span>/srv/api<span class=\"token punctuation\">:</span>rw<span class=\"token punctuation\">,</span>cached\n      <span class=\"token punctuation\">-</span> ./api/docker/php/conf.d/api<span class=\"token punctuation\">-</span>platform.dev.ini<span class=\"token punctuation\">:</span>/usr/local/etc/php/conf.d/api<span class=\"token punctuation\">-</span>platform.ini\n      <span class=\"token punctuation\">-</span> ./certs<span class=\"token punctuation\">:</span>/certs<span class=\"token punctuation\">:</span>ro\n    <span class=\"token key atrule\">&lt;&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token important\">*network</span>\n\n  <span class=\"token key atrule\">api</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">context</span><span class=\"token punctuation\">:</span> ./api\n      <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> api_platform_nginx\n      <span class=\"token key atrule\">&lt;&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token important\">*cache</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>NGINX_IMAGE<span class=\"token punctuation\">:</span><span class=\"token punctuation\">-</span>quay.io/api<span class=\"token punctuation\">-</span>platform/nginx<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> php\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./api/public<span class=\"token punctuation\">:</span>/srv/api/public<span class=\"token punctuation\">:</span>ro\n    <span class=\"token key atrule\">&lt;&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token important\">*network</span>\n\n  <span class=\"token key atrule\">vulcain</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> dunglas/vulcain\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> CERT_FILE=/certs/localhost.crt\n      <span class=\"token punctuation\">-</span> KEY_FILE=/certs/localhost.key\n      <span class=\"token punctuation\">-</span> UPSTREAM=http<span class=\"token punctuation\">:</span>//api\n    <span class=\"token key atrule\">depends_on</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> api\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./certs<span class=\"token punctuation\">:</span>/certs<span class=\"token punctuation\">:</span>ro\n    <span class=\"token key atrule\">&lt;&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token important\">*network</span>\n\n  <span class=\"token key atrule\">db</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> postgres<span class=\"token punctuation\">:</span>12<span class=\"token punctuation\">-</span>alpine\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> POSTGRES_DB=$<span class=\"token punctuation\">{</span>DB_NAME<span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">-</span> POSTGRES_PASSWORD=$<span class=\"token punctuation\">{</span>DB_PASS<span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">-</span> POSTGRES_USER=$<span class=\"token punctuation\">{</span>DB_USER<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> db<span class=\"token punctuation\">-</span>data<span class=\"token punctuation\">:</span>/var/lib/postgresql/data<span class=\"token punctuation\">:</span>rw\n    <span class=\"token key atrule\">&lt;&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token important\">*network</span>\n\n  <span class=\"token key atrule\">mercure</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> dunglas/mercure\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n<span class=\"token comment\">#      - ACME_HOSTS=${DOMAIN_NAME}</span>\n<span class=\"token comment\">#      - CERT_FILE=/certs/localhost.crt</span>\n<span class=\"token comment\">#      - KEY_FILE=/certs/localhost.key</span>\n      <span class=\"token punctuation\">-</span> JWT_KEY=$<span class=\"token punctuation\">{</span>JWT_KEY<span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">-</span> ALLOW_ANONYMOUS=1\n      <span class=\"token punctuation\">-</span> USE_FORWARDED_HEADERS=true\n      <span class=\"token punctuation\">-</span> CORS_ALLOWED_ORIGINS=*\n      <span class=\"token punctuation\">-</span> READ_TIMEOUT=0s\n      <span class=\"token punctuation\">-</span> WRITE_TIMEOUT=0s\n      <span class=\"token punctuation\">-</span> PUBLISH_ALLOWED_ORIGINS=*\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./certs<span class=\"token punctuation\">:</span>/certs<span class=\"token punctuation\">:</span>ro\n    <span class=\"token key atrule\">&lt;&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token important\">*network</span>\n\n  <span class=\"token key atrule\">client</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">context</span><span class=\"token punctuation\">:</span> ./client\n      <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> api_platform_client_development\n      <span class=\"token key atrule\">cache_from</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>CLIENT_IMAGE<span class=\"token punctuation\">:</span><span class=\"token punctuation\">-</span>quay.io/api<span class=\"token punctuation\">-</span>platform/client<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>CLIENT_IMAGE<span class=\"token punctuation\">:</span><span class=\"token punctuation\">-</span>quay.io/api<span class=\"token punctuation\">-</span>platform/client<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">tty</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> API_PLATFORM_CLIENT_GENERATOR_ENTRYPOINT=http<span class=\"token punctuation\">:</span>//api\n      <span class=\"token punctuation\">-</span> API_PLATFORM_CLIENT_GENERATOR_OUTPUT=src\n      <span class=\"token comment\"># You should remove this variable from .env into client folder</span>\n      <span class=\"token punctuation\">-</span> REACT_APP_API_ENTRYPOINT=$<span class=\"token punctuation\">{</span>HTTP_OR_SSL<span class=\"token punctuation\">}</span>api.$<span class=\"token punctuation\">{</span>DOMAIN_NAME<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./client<span class=\"token punctuation\">:</span>/usr/src/client<span class=\"token punctuation\">:</span>rw<span class=\"token punctuation\">,</span>cached\n    <span class=\"token key atrule\">&lt;&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token important\">*network</span>\n\n  <span class=\"token key atrule\">admin</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">build</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">context</span><span class=\"token punctuation\">:</span> ./admin\n      <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> api_platform_admin_development\n      <span class=\"token key atrule\">cache_from</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> $<span class=\"token punctuation\">{</span>ADMIN_IMAGE<span class=\"token punctuation\">:</span><span class=\"token punctuation\">-</span>quay.io/api<span class=\"token punctuation\">-</span>platform/admin<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span>ADMIN_IMAGE<span class=\"token punctuation\">:</span><span class=\"token punctuation\">-</span>quay.io/api<span class=\"token punctuation\">-</span>platform/admin<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">tty</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span>\n      <span class=\"token comment\"># You should remove this variable from .env into client folder</span>\n      <span class=\"token punctuation\">-</span> REACT_APP_API_ENTRYPOINT=$<span class=\"token punctuation\">{</span>HTTP_OR_SSL<span class=\"token punctuation\">}</span>api.$<span class=\"token punctuation\">{</span>DOMAIN_NAME<span class=\"token punctuation\">}</span>\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> ./admin<span class=\"token punctuation\">:</span>/usr/src/admin<span class=\"token punctuation\">:</span>rw<span class=\"token punctuation\">,</span>cached\n    <span class=\"token key atrule\">&lt;&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token important\">*network</span>\n\n<span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">db-data</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n<span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">api_platform_network</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">external</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># /anywhere/traefik/docker-compose.yml</span>\n<span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'3.4'</span>\n\n<span class=\"token key atrule\">x-network</span><span class=\"token punctuation\">:</span>\n  <span class=\"token important\">&amp;network</span>\n  <span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> api_platform_network\n\n<span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">traefik</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> traefik<span class=\"token punctuation\">:</span>latest\n    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n        <span class=\"token key atrule\">published</span><span class=\"token punctuation\">:</span> <span class=\"token number\">80</span>\n        <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> tcp\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> <span class=\"token number\">443</span>\n        <span class=\"token key atrule\">published</span><span class=\"token punctuation\">:</span> <span class=\"token number\">443</span>\n        <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> tcp\n      <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">target</span><span class=\"token punctuation\">:</span> <span class=\"token number\">8080</span>\n        <span class=\"token key atrule\">published</span><span class=\"token punctuation\">:</span> <span class=\"token number\">8080</span>\n        <span class=\"token key atrule\">protocol</span><span class=\"token punctuation\">:</span> tcp\n\n    <span class=\"token key atrule\">volumes</span><span class=\"token punctuation\">:</span>\n      <span class=\"token punctuation\">-</span> /var/run/docker.sock<span class=\"token punctuation\">:</span>/var/run/docker.sock\n      <span class=\"token punctuation\">-</span> ./traefik.toml<span class=\"token punctuation\">:</span>/etc/traefik/traefik.toml\n      <span class=\"token punctuation\">-</span> ./acme.json<span class=\"token punctuation\">:</span>/acme.json\n    <span class=\"token key atrule\">&lt;&lt;</span><span class=\"token punctuation\">:</span> <span class=\"token important\">*network</span>\n\n<span class=\"token key atrule\">networks</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">api_platform_network</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">external</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span></code></pre></div>\n<p>For a more detailed step-by-step configuration, take a look at <a href=\"https://github.com/darkweak/WorkshopContainous\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">this repository</a> which include Fail2ban link to Træfik instance.</p>","nav":{"chapters":[{"title":"The Distribution: Create Powerful APIs with Ease","path":"distribution","items":[{"id":"index","title":"Getting Started with API Platform: Hypermedia and GraphQL API, Admin and Progressive Web App","anchors":[{"id":"installing-the-framework","title":"Installing the Framework","anchors":[{"id":"using-the-api-platform-distribution-recommended","title":"Using the API Platform Distribution (Recommended)"},{"id":"using-symfony-flex-and-composer-advanced-users","title":"Using Symfony Flex and Composer (Advanced Users)"}]},{"id":"its-ready","title":"It's Ready!"},{"id":"bringing-your-own-model","title":"Bringing your Own Model"},{"id":"validating-data","title":"Validating Data"},{"id":"adding-graphql-support","title":"Adding GraphQL Support"},{"id":"the-admin","title":"The Admin"},{"id":"a-react-progressive-web-app","title":"A React Progressive Web App"},{"id":"hooking-your-own-business-logic","title":"Hooking Your Own Business Logic"},{"id":"other-features","title":"Other Features"},{"id":"screencasts","title":"Screencasts"}]},{"id":"testing","title":"Testing the API","anchors":[{"id":"creating-data-fixtures","title":"Creating Data Fixtures"},{"id":"writing-functional-tests","title":"Writing Functional Tests"},{"id":"writing-unit-tests","title":"Writing Unit Tests"},{"id":"additional-and-alternative-testing-tools","title":"Additional and Alternative Testing Tools"}]},{"id":"debugging","title":"Debugging","anchors":[{"id":"xdebug","title":"Xdebug"},{"id":"add-a-development-stage-to-the-dockerfile","title":"Add a Development Stage to the Dockerfile"},{"id":"configure-xdebug-with-docker-compose-override","title":"Configure Xdebug with Docker Compose Override"},{"id":"troubleshooting","title":"Troubleshooting"}]}]},{"title":"The API Component","path":"core","items":[{"id":"index","title":"The API Platform Core Library","anchors":[{"id":"features","title":"Features"},{"id":"screencasts","title":"Screencasts"}]},{"id":"getting-started","title":"Getting started","anchors":[{"id":"installing-api-platform-core","title":"Installing API Platform Core"},{"id":"before-reading-this-documentation","title":"Before Reading this Documentation"},{"id":"mapping-the-entities","title":"Mapping the Entities"}]},{"id":"design","title":"General Design Considerations"},{"id":"extending","title":"Extending API Platform","anchors":[{"id":"doctrine-specific-extension-points","title":"Doctrine Specific Extension Points"},{"id":"leveraging-the-built-in-infrastructure-using-composition","title":"Leveraging the Built-in Infrastructure Using Composition"}]},{"id":"testing","title":"Testing Utilities","anchors":[{"id":"the-test-httpclient","title":"The Test HttpClient"},{"id":"api-test-assertions","title":"API Test Assertions"},{"id":"http-test-assertions","title":"HTTP Test Assertions"}]},{"id":"operations","title":"Operations","anchors":[{"id":"enabling-and-disabling-operations","title":"Enabling and Disabling Operations"},{"id":"configuring-operations","title":"Configuring Operations"},{"id":"prefixing-all-routes-of-all-operations","title":"Prefixing All Routes of All Operations"},{"id":"expose-a-model-without-any-routes","title":"Expose a model without any routes"}]},{"id":"graphql","title":"GraphQL Support","anchors":[{"id":"enabling-graphql","title":"Enabling GraphQL"},{"id":"changing-location-of-the-graphql-endpoint","title":"Changing Location of the GraphQL Endpoint"},{"id":"graphiql","title":"GraphiQL","anchors":[{"id":"add-another-location-for-graphiql","title":"Add another Location for GraphiQL"}]},{"id":"graphql-playground","title":"GraphQL Playground","anchors":[{"id":"add-another-location-for-graphql-playground","title":"Add another Location for GraphQL Playground"}]},{"id":"modifying-or-disabling-the-default-ide","title":"Modifying or Disabling the Default IDE"},{"id":"request-with-applicationgraphql-content-type","title":"Request with application/graphql Content-Type"},{"id":"operations","title":"Operations"},{"id":"queries","title":"Queries","anchors":[{"id":"global-object-identifier","title":"Global Object Identifier"},{"id":"custom-queries","title":"Custom Queries"}]},{"id":"mutations","title":"Mutations","anchors":[{"id":"client-mutation-id","title":"Client Mutation Id"},{"id":"custom-mutations","title":"Custom Mutations"}]},{"id":"subscriptions","title":"Subscriptions","anchors":[{"id":"enable-update-subscriptions-for-a-resource","title":"Enable Update Subscriptions for a Resource"},{"id":"subscribe","title":"Subscribe"},{"id":"receiving-an-update","title":"Receiving an Update"},{"id":"subscriptions-cache","title":"Subscriptions Cache"}]},{"id":"workflow-of-the-resolvers","title":"Workflow of the Resolvers","anchors":[{"id":"disabling-resolver-stages","title":"Disabling Resolver Stages"}]},{"id":"events","title":"Events"},{"id":"filters","title":"Filters","anchors":[{"id":"syntax-for-filters-with-a-list-of-key--value-arguments","title":"Syntax for Filters with a List of Key / Value Arguments"},{"id":"filtering-on-nested-properties","title":"Filtering on Nested Properties"}]},{"id":"pagination","title":"Pagination","anchors":[{"id":"using-the-cursor-based-pagination","title":"Using the Cursor-based Pagination"},{"id":"using-the-page-based-pagination","title":"Using the Page-based Pagination"},{"id":"disabling-the-pagination","title":"Disabling the Pagination","anchors":[{"id":"globally","title":"Globally"},{"id":"for-a-specific-resource","title":"For a Specific Resource"},{"id":"for-a-specific-resource-collection-operation","title":"For a Specific Resource Collection Operation"}]}]},{"id":"security","title":"Security"},{"id":"serialization-groups","title":"Serialization Groups","anchors":[{"id":"different-types-when-using-different-serialization-groups","title":"Different Types when Using Different Serialization Groups"}]},{"id":"exception-and-error","title":"Exception and Error","anchors":[{"id":"handling-exceptions-and-errors-logging-filtering-","title":"Handling Exceptions and Errors (Logging, Filtering, ...)"},{"id":"formatting-exceptions-and-errors","title":"Formatting Exceptions and Errors","anchors":[{"id":"custom-exception-normalizer","title":"Custom Exception Normalizer"}]}]},{"id":"name-conversion","title":"Name Conversion","anchors":[{"id":"nesting-separator","title":"Nesting Separator"}]},{"id":"custom-types","title":"Custom Types"},{"id":"modify-the-extracted-types","title":"Modify the Extracted Types"},{"id":"changing-the-serialization-context-dynamically","title":"Changing the Serialization Context Dynamically"},{"id":"export-the-schema-in-sdl","title":"Export the Schema in SDL"},{"id":"handling-file-upload","title":"Handling File Upload","anchors":[{"id":"configuring-the-entity-receiving-the-uploaded-file","title":"Configuring the Entity Receiving the Uploaded File"},{"id":"resolving-the-file-upload","title":"Resolving the File Upload"},{"id":"using-the-createmediaobject-mutation","title":"Using the createMediaObject Mutation"}]},{"id":"change-default-descriptions","title":"Change Default Descriptions"}]},{"id":"data-providers","title":"Data Providers","anchors":[{"id":"custom-collection-data-provider","title":"Custom Collection Data Provider"},{"id":"custom-item-data-provider","title":"Custom Item Data Provider"},{"id":"injecting-the-serializer-in-an-itemdataprovider","title":"Injecting the Serializer in an ItemDataProvider"},{"id":"injecting-extensions-pagination-filter-eagerloading-etc","title":"Injecting Extensions (Pagination, Filter, EagerLoading etc.)"},{"id":"community-data-providers","title":"Community Data Providers"}]},{"id":"data-persisters","title":"Data Persisters","anchors":[{"id":"creating-a-custom-data-persister","title":"Creating a Custom Data Persister"},{"id":"decorating-the-built-in-data-persisters","title":"Decorating the Built-In Data Persisters"}]},{"id":"filters","title":"Filters","anchors":[{"id":"doctrine-orm-and-mongodb-odm-filters","title":"Doctrine ORM and MongoDB ODM Filters","anchors":[{"id":"basic-knowledge","title":"Basic Knowledge"},{"id":"search-filter","title":"Search Filter"},{"id":"date-filter","title":"Date Filter","anchors":[{"id":"managing-null-values","title":"Managing null Values"}]},{"id":"boolean-filter","title":"Boolean Filter"},{"id":"numeric-filter","title":"Numeric Filter"},{"id":"range-filter","title":"Range Filter"},{"id":"exists-filter","title":"Exists Filter","anchors":[{"id":"using-a-custom-exists-query-parameter-name","title":"Using a Custom Exists Query Parameter Name"}]},{"id":"order-filter-sorting","title":"Order Filter (Sorting)","anchors":[{"id":"comparing-with-null-values","title":"Comparing with Null Values"},{"id":"using-a-custom-order-query-parameter-name","title":"Using a Custom Order Query Parameter Name"}]},{"id":"filtering-on-nested-properties","title":"Filtering on Nested Properties"},{"id":"enabling-a-filter-for-all-properties-of-a-resource","title":"Enabling a Filter for All Properties of a Resource"}]},{"id":"elasticsearch-filters","title":"Elasticsearch Filters","anchors":[{"id":"ordering-filter-sorting","title":"Ordering Filter (Sorting)","anchors":[{"id":"using-a-custom-order-query-parameter-name","title":"Using a Custom Order Query Parameter Name"}]},{"id":"match-filter","title":"Match Filter"},{"id":"term-filter","title":"Term Filter"},{"id":"filtering-on-nested-properties","title":"Filtering on Nested Properties"}]},{"id":"serializer-filters","title":"Serializer Filters","anchors":[{"id":"group-filter","title":"Group Filter"},{"id":"property-filter","title":"Property filter"}]},{"id":"creating-custom-filters","title":"Creating Custom Filters","anchors":[{"id":"creating-custom-doctrine-orm-filters","title":"Creating Custom Doctrine ORM Filters"},{"id":"creating-custom-doctrine-mongodb-odm-filters","title":"Creating Custom Doctrine MongoDB ODM Filters"},{"id":"creating-custom-elasticsearch-filters","title":"Creating Custom Elasticsearch Filters"},{"id":"using-doctrine-orm-filters","title":"Using Doctrine ORM Filters"}]},{"id":"apifilter-annotation","title":"ApiFilter Annotation"}]},{"id":"subresources","title":"Subresources","anchors":[{"id":"using-serialization-groups","title":"Using Serialization Groups"},{"id":"using-custom-paths","title":"Using Custom Paths","anchors":[{"id":"access-control-of-subresources","title":"Access Control of Subresources"},{"id":"limiting-depth","title":"Limiting Depth"}]}]},{"id":"serialization","title":"The Serialization Process","anchors":[{"id":"overall-process","title":"Overall Process"},{"id":"available-serializers","title":"Available Serializers"},{"id":"the-serialization-context-groups-and-relations","title":"The Serialization Context, Groups and Relations","anchors":[{"id":"configuration","title":"Configuration"}]},{"id":"using-serialization-groups","title":"Using Serialization Groups"},{"id":"using-serialization-groups-per-operation","title":"Using Serialization Groups per Operation"},{"id":"embedding-relations","title":"Embedding Relations","anchors":[{"id":"normalization","title":"Normalization"},{"id":"denormalization","title":"Denormalization"},{"id":"force-iri-with-relations-of-the-same-type-parentchilds-relations","title":"Force IRI with relations of the same type (parent/childs relations)"}]},{"id":"calculated-field","title":"Calculated Field"},{"id":"changing-the-serialization-context-dynamically","title":"Changing the Serialization Context Dynamically"},{"id":"changing-the-serialization-context-on-a-per-item-basis","title":"Changing the Serialization Context on a Per-item Basis"},{"id":"name-conversion","title":"Name Conversion"},{"id":"decorating-a-serializer-and-adding-extra-data","title":"Decorating a Serializer and Adding Extra Data"},{"id":"entity-identifier-case","title":"Entity Identifier Case"},{"id":"embedding-the-json-ld-context","title":"Embedding the JSON-LD Context"},{"id":"collection-relation","title":"Collection Relation"}]},{"id":"validation","title":"Validation","anchors":[{"id":"validating-submitted-data","title":"Validating Submitted Data"},{"id":"using-validation-groups","title":"Using Validation Groups"},{"id":"using-validation-groups-on-operations","title":"Using Validation Groups on Operations"},{"id":"dynamic-validation-groups","title":"Dynamic Validation Groups"},{"id":"sequential-validation-groups","title":"Sequential Validation Groups"},{"id":"error-levels-and-payload-serialization","title":"Error Levels and Payload Serialization"},{"id":"validation-on-collection-relations","title":"Validation on Collection Relations"},{"id":"open-vocabulary-generated-from-validation-metadata","title":"Open Vocabulary Generated from Validation Metadata"},{"id":"specification-property-restrictions","title":"Specification property restrictions"}]},{"id":"security","title":"Security","anchors":[{"id":"executing-access-control-rules-after-denormalization","title":"Executing Access Control Rules After Denormalization"},{"id":"hooking-custom-permission-checks-using-voters","title":"Hooking Custom Permission Checks Using Voters"},{"id":"configuring-the-access-control-error-message","title":"Configuring the Access Control Error Message"},{"id":"filtering-collection-according-to-the-current-user-permissions","title":"Filtering Collection According to the Current User Permissions"},{"id":"disabling-operations","title":"Disabling Operations"},{"id":"changing-serialization-groups-depending-of-the-current-user","title":"Changing Serialization Groups Depending of the Current User"}]},{"id":"content-negotiation","title":"Content Negotiation","anchors":[{"id":"configuring-formats-globally","title":"Configuring Formats Globally"},{"id":"configuring-patch-formats","title":"Configuring PATCH Formats"},{"id":"configuring-error-formats","title":"Configuring Error Formats"},{"id":"configuring-formats-for-a-specific-resource-or-operation","title":"Configuring Formats For a Specific Resource or Operation"},{"id":"supporting-custom-formats","title":"Supporting Custom Formats","anchors":[{"id":"reusing-the-api-platform-infrastructure","title":"Reusing the API Platform Infrastructure"},{"id":"contributing-support-for-new-formats","title":"Contributing Support for New Formats"}]}]},{"id":"pagination","title":"Pagination","anchors":[{"id":"disabling-the-pagination","title":"Disabling the Pagination","anchors":[{"id":"globally","title":"Globally"},{"id":"for-a-specific-resource","title":"For a Specific Resource"},{"id":"client-side","title":"Client-side","anchors":[{"id":"globally","title":"Globally"},{"id":"for-a-specific-resource","title":"For a specific resource"}]}]},{"id":"changing-the-number-of-items-per-page","title":"Changing the Number of Items per Page","anchors":[{"id":"globally","title":"Globally"},{"id":"for-a-specific-resource","title":"For a Specific Resource"},{"id":"client-side","title":"Client-side","anchors":[{"id":"globally","title":"Globally"},{"id":"for-a-specific-resource","title":"For a Specific Resource"}]}]},{"id":"changing-maximum-items-per-page","title":"Changing Maximum items per page","anchors":[{"id":"globally","title":"Globally"},{"id":"for-a-specific-resource","title":"For a Specific Resource"},{"id":"for-a-specific-resource-collection-operation","title":"For a Specific Resource Collection Operation"}]},{"id":"partial-pagination","title":"Partial Pagination","anchors":[{"id":"globally","title":"Globally"},{"id":"for-a-specific-resource","title":"For a Specific Resource"},{"id":"client-side","title":"Client-side","anchors":[{"id":"globally","title":"Globally"},{"id":"for-a-specific-resource","title":"For a Specific Resource"}]}]},{"id":"cursor-based-pagination","title":"Cursor based pagination"},{"id":"controlling-the-behavior-of-the-doctrine-orm-paginator","title":"Controlling the behavior of the Doctrine ORM Paginator"},{"id":"custom-controller-action","title":"Custom Controller Action"}]},{"id":"deprecations","title":"Deprecating Resources and Properties (Alternative to Versioning)","anchors":[{"id":"deprecating-resource-classes-operations-and-properties","title":"Deprecating Resource Classes, Operations and Properties"},{"id":"setting-the-sunset-http-header-to-indicate-when-a-resource-or-an-operation-will-be-removed","title":"Setting the Sunset HTTP Header to Indicate When a Resource or an Operation Will Be Removed"}]},{"id":"default-order","title":"Overriding Default Order"},{"id":"performance","title":"Performance and Cache","anchors":[{"id":"enabling-the-built-in-http-cache-invalidation-system","title":"Enabling the Built-in HTTP Cache Invalidation System","anchors":[{"id":"extending-cache-tags-for-invalidation","title":"Extending Cache-Tags for Invalidation"}]},{"id":"setting-custom-http-cache-headers","title":"Setting Custom HTTP Cache Headers"},{"id":"enabling-the-metadata-cache","title":"Enabling the Metadata Cache"},{"id":"using-ppm-php-pm","title":"Using PPM (PHP-PM)"},{"id":"doctrine-queries-and-indexes","title":"Doctrine Queries and Indexes","anchors":[{"id":"search-filter","title":"Search Filter"},{"id":"eager-loading","title":"Eager Loading","anchors":[{"id":"max-joins","title":"Max Joins"},{"id":"fetch-partial","title":"Fetch Partial"},{"id":"force-eager","title":"Force Eager"},{"id":"override-at-resource-and-operation-level","title":"Override at Resource and Operation Level"},{"id":"disable-eager-loading","title":"Disable Eager Loading"}]},{"id":"partial-pagination","title":"Partial Pagination"}]},{"id":"profiling-with-blackfireio","title":"Profiling with Blackfire.io"}]},{"id":"extensions","title":"Extensions","anchors":[{"id":"custom-doctrine-orm-extension","title":"Custom Doctrine ORM Extension","anchors":[{"id":"example","title":"Example","anchors":[{"id":"blocking-anonymous-users","title":"Blocking Anonymous Users"}]}]},{"id":"custom-doctrine-mongodb-odm-extension","title":"Custom Doctrine MongoDB ODM Extension"},{"id":"custom-elasticsearch-extension","title":"Custom Elasticsearch Extension"}]},{"id":"messenger","title":"Symfony Messenger Integration: CQRS and Async Message Processing","anchors":[{"id":"installing-symfony-messenger","title":"Installing Symfony Messenger"},{"id":"dispatching-a-resource-through-the-message-bus","title":"Dispatching a Resource through the Message Bus"},{"id":"registering-a-message-handler","title":"Registering a Message Handler"},{"id":"accessing-the-data-returned-by-the-handler","title":"Accessing the Data Returned by the Handler"},{"id":"detecting-removals","title":"Detecting Removals"},{"id":"using-messenger-with-an-input-object","title":"Using Messenger with an Input Object"}]},{"id":"dto","title":"Using Data Transfer Objects (DTOs)","anchors":[{"id":"specifying-an-input-or-an-output-data-representation","title":"Specifying an Input or an Output Data Representation"},{"id":"updating-a-resource-with-a-custom-input","title":"Updating a Resource with a Custom Input"},{"id":"disabling-the-input-or-the-output","title":"Disabling the Input or the Output"},{"id":"per-operation-input-and-output","title":"Per Operation input and output"},{"id":"inputoutput-metadata","title":"Input/Output Metadata"},{"id":"using-objects-as-relations-inside-resources","title":"Using Objects As Relations Inside Resources"},{"id":"validating-data-transfer-objects","title":"Validating Data Transfer Objects"}]},{"id":"openapi","title":"OpenAPI Specification Support (formerly Swagger)","anchors":[{"id":"using-the-openapi-command","title":"Using the OpenAPI Command"},{"id":"overriding-the-openapi-specification","title":"Overriding the OpenAPI Specification"},{"id":"using-the-openapi-and-swagger-contexts","title":"Using the OpenAPI and Swagger Contexts"},{"id":"changing-the-name-of-a-definition","title":"Changing the Name of a Definition"},{"id":"changing-operations-in-the-openapi-documentation","title":"Changing Operations in the OpenAPI Documentation"},{"id":"changing-the-location-of-swagger-ui","title":"Changing the Location of Swagger UI","anchors":[{"id":"disabling-swagger-ui-or-redoc","title":"Disabling Swagger UI or ReDoc"},{"id":"manually-registering-the-swagger-ui-controller","title":"Manually Registering the Swagger UI Controller"}]},{"id":"overriding-the-ui-template","title":"Overriding the UI Template"},{"id":"compatibility-layer-with-amazon-api-gateway","title":"Compatibility Layer with Amazon API Gateway"},{"id":"oauth","title":"OAuth"}]},{"id":"json-schema","title":"JSON Schema Support","anchors":[{"id":"generating-a-json-schema","title":"Generating a JSON Schema"},{"id":"generating-a-json-schema-programmatically","title":"Generating a JSON Schema Programmatically"},{"id":"testing","title":"Testing"}]},{"id":"mercure","title":"Creating Async APIs using the Mercure Protocol","anchors":[{"id":"installing-mercure-support","title":"Installing Mercure Support"},{"id":"pushing-the-api-updates","title":"Pushing the API Updates"},{"id":"dispatching-private-updates-authorized-mode","title":"Dispatching Private Updates (Authorized Mode)"},{"id":"available-options","title":"Available Options"}]},{"id":"push-relations","title":"Pushing Related Resources Using HTTP/2"},{"id":"errors","title":"Errors Handling","anchors":[{"id":"converting-php-exceptions-to-http-errors","title":"Converting PHP Exceptions to HTTP Errors"}]},{"id":"external-vocabularies","title":"Using External Vocabularies"},{"id":"operation-path-naming","title":"Operation Path Naming","anchors":[{"id":"configuration","title":"Configuration"},{"id":"create-a-custom-operation-path-resolver","title":"Create a Custom Operation Path Resolver","anchors":[{"id":"defining-the-operation-segment-name-generator","title":"Defining the Operation Segment Name Generator"},{"id":"registering-the-service","title":"Registering the Service"},{"id":"configuring-it","title":"Configuring It"}]}]},{"id":"extending-jsonld-context","title":"Extending JSON-LD AND Hydra Contexts","anchors":[{"id":"json-ld","title":"JSON-LD"},{"id":"hydra","title":"Hydra"}]},{"id":"identifiers","title":"Identifiers","anchors":[{"id":"custom-identifier-normalizer","title":"Custom Identifier Normalizer"},{"id":"changing-identifier-in-a-doctrine-entity","title":"Changing Identifier in a Doctrine Entity"},{"id":"supported-identifiers","title":"Supported Identifiers"}]},{"id":"mongodb","title":"MongoDB Support","anchors":[{"id":"overview","title":"Overview"},{"id":"enabling-mongodb-support","title":"Enabling MongoDB Support"},{"id":"creating-documents","title":"Creating Documents"},{"id":"filtering","title":"Filtering"},{"id":"creating-custom-extensions","title":"Creating Custom Extensions"},{"id":"adding-execute-options","title":"Adding Execute Options"}]},{"id":"elasticsearch","title":"Elasticsearch Support","anchors":[{"id":"overview","title":"Overview"},{"id":"enabling-reading-support","title":"Enabling Reading Support"},{"id":"creating-models","title":"Creating Models","anchors":[{"id":"creating-custom-mapping","title":"Creating custom mapping"}]},{"id":"filtering","title":"Filtering"},{"id":"creating-custom-extensions","title":"Creating Custom Extensions"}]},{"id":"controllers","title":"Creating Custom Operations and Controllers","anchors":[{"id":"using-serialization-groups","title":"Using Serialization Groups"},{"id":"retrieving-the-entity","title":"Retrieving the Entity"},{"id":"alternative-method","title":"Alternative Method"}]},{"id":"events","title":"The Event System","anchors":[{"id":"built-in-event-listeners","title":"Built-in Event Listeners"},{"id":"custom-event-listeners","title":"Custom Event Listeners"}]},{"id":"file-upload","title":"Handling File Upload","anchors":[{"id":"installing-vichuploaderbundle","title":"Installing VichUploaderBundle"},{"id":"configuring-the-entity-receiving-the-uploaded-file","title":"Configuring the Entity Receiving the Uploaded File"},{"id":"handling-file-upload","title":"Handling File Upload"},{"id":"resolving-the-file-url","title":"Resolving the File URL"},{"id":"making-a-request-to-the-media_objects-endpoint","title":"Making a Request to the /media_objects Endpoint"},{"id":"linking-a-mediaobject-resource-to-another-resource","title":"Linking a MediaObject Resource to Another Resource"}]},{"id":"jwt","title":"JWT Authentication","anchors":[{"id":"installing-lexikjwtauthenticationbundle","title":"Installing LexikJWTAuthenticationBundle"},{"id":"configuring-the-symfony-securitybundle","title":"Configuring the Symfony SecurityBundle","anchors":[{"id":"adding-authentication-to-an-api-which-uses-a-path-prefix","title":"Adding Authentication to an API Which Uses a Path Prefix"}]},{"id":"documenting-the-authentication-mechanism-with-swaggeropen-api","title":"Documenting the Authentication Mechanism with Swagger/Open API","anchors":[{"id":"configuring-api-platform","title":"Configuring API Platform"},{"id":"adding-a-new-api-key","title":"Adding a New API Key"},{"id":"adding-endpoint-to-swaggerui-to-retrieve-a-jwt-token","title":"Adding endpoint to SwaggerUI to retrieve a JWT token"}]},{"id":"testing-with-behat","title":"Testing with Behat"}]},{"id":"form-data","title":"Accept application/x-www-form-urlencoded Form Data","anchors":[{"id":"create-your-deserializelistener-decorator","title":"Create your DeserializeListener Decorator"},{"id":"creating-the-service-definition","title":"Creating the Service Definition"}]},{"id":"angularjs-integration","title":"AngularJS Integration","anchors":[{"id":"restangular","title":"Restangular"},{"id":"ng-admin","title":"ng-admin"}]},{"id":"fosuser-bundle","title":"FOSUserBundle Integration","anchors":[{"id":"installing-the-bundle","title":"Installing the Bundle"},{"id":"enabling-the-bridge","title":"Enabling the Bridge"},{"id":"creating-a-user-entity-with-serialization-groups","title":"Creating a User Entity with Serialization Groups"}]},{"id":"nelmio-api-doc","title":"NelmioApiDocBundle Integration"},{"id":"configuration","title":"Configuration"}]},{"title":"The Schema Generator Component","path":"schema-generator","items":[{"id":"index","title":"The Schema Generator","anchors":[{"id":"what-is-schemaorg","title":"What Is Schema.org?"},{"id":"why-use-schemaorg-data-to-generate-a-php-model","title":"Why Use Schema.org Data to Generate a PHP Model?","anchors":[{"id":"dont-reinvent-the-wheel","title":"Don't Reinvent the Wheel"},{"id":"improve-seo-and-user-experience","title":"Improve SEO and User Experience"},{"id":"be-ready-for-the-future","title":"Be Ready for The Future"}]},{"id":"documentation","title":"Documentation"}]},{"id":"getting-started","title":"Getting Started","anchors":[{"id":"installation","title":"Installation"},{"id":"model-scaffolding","title":"Model Scaffolding","anchors":[{"id":"going-further","title":"Going Further"}]},{"id":"cardinality-extraction","title":"Cardinality Extraction"}]},{"id":"configuration","title":"Configuration","anchors":[{"id":"customizing-php-namespaces","title":"Customizing PHP Namespaces"},{"id":"forcing-a-field-range","title":"Forcing a Field Range"},{"id":"forcing-a-field-cardinality","title":"Forcing a Field Cardinality"},{"id":"forcing-a-relation-table-name","title":"Forcing a Relation Table Name"},{"id":"forcing-or-disabling-a-class-parent","title":"Forcing (or Disabling) a Class Parent"},{"id":"forcing-a-class-to-be-abstract","title":"Forcing a Class to be Abstract"},{"id":"forcing-a-nullable-property","title":"Forcing a Nullable Property"},{"id":"forcing-a-unique-property","title":"Forcing a Unique Property"},{"id":"making-a-property-read-only","title":"Making a Property Read-Only"},{"id":"making-a-property-write-only","title":"Making a Property Write-Only"},{"id":"forcing-a-property-to-be-in-a-serialization-group","title":"Forcing a Property to be in a Serialization Group"},{"id":"forcing-an-embeddable-class-to-be-embedded","title":"Forcing an Embeddable Class to be Embedded"},{"id":"author-phpdoc","title":"Author PHPDoc"},{"id":"disabling-generators-and-creating-custom-ones","title":"Disabling Generators and Creating Custom Ones"},{"id":"skipping-accessor-method-generation","title":"Skipping Accessor Method Generation"},{"id":"disabling-the-id-generator","title":"Disabling the id Generator"},{"id":"generating-uuids","title":"Generating UUIDs"},{"id":"user-submitted-uuids","title":"User submitted UUIDs"},{"id":"generating-custom-ids","title":"Generating Custom IDs"},{"id":"disabling-usage-of-doctrine-collections","title":"Disabling Usage of Doctrine Collections"},{"id":"changing-the-field-visibility","title":"Changing the Field Visibility"},{"id":"generating-asserttype-annotations","title":"Generating @Assert\\Type Annotations"},{"id":"forcing-doctrine-inheritance-mapping-annotation","title":"Forcing Doctrine Inheritance Mapping Annotation"},{"id":"interfaces-and-doctrine-resolve-target-entity-listener","title":"Interfaces and Doctrine Resolve Target Entity Listener"},{"id":"custom-schemas","title":"Custom Schemas"},{"id":"checking-goodrelation-compatibility","title":"Checking GoodRelation Compatibility"},{"id":"php-file-header","title":"PHP File Header"},{"id":"full-configuration-reference","title":"Full Configuration Reference"}]}]},{"title":"The Admin Component","path":"admin","items":[{"id":"index","title":"The API Platform Admin","anchors":[{"id":"features","title":"Features"}]},{"id":"getting-started","title":"Getting Started","anchors":[{"id":"installation","title":"Installation"},{"id":"creating-the-admin","title":"Creating the Admin"}]},{"id":"handling-relations","title":"Handling Relations","anchors":[{"id":"embedded-relations","title":"Embedded Relations"},{"id":"display-a-field-of-an-embedded-relation","title":"Display a Field of an Embedded Relation"},{"id":"using-an-autocomplete-input-for-relations","title":"Using an Autocomplete Input for Relations"}]},{"id":"schema.org","title":"Using the Schema.org Vocabulary","anchors":[{"id":"displaying-related-resources-name-instead-of-its-iri","title":"Displaying Related Resource's Name Instead of its IRI"},{"id":"emails-urls-and-identifiers","title":"Emails, URLs and Identifiers"}]},{"id":"authentication-support","title":"Authentication Support"},{"id":"performance","title":"Performance","anchors":[{"id":"retrieve-all-relations-in-one-request","title":"Retrieve All Relations in One Request"}]},{"id":"customizing","title":"Customizing the Admin","anchors":[{"id":"customizing-the-admins-main-page-and-the-resource-list","title":"Customizing the Admin's Main Page and the Resource List"},{"id":"customizing-the-list-view","title":"Customizing the List View"},{"id":"customizing-the-show-view","title":"Customizing the Show View"},{"id":"customizing-the-create-form","title":"Customizing the Create Form"},{"id":"customizing-the-edit-form","title":"Customizing the Edit Form"},{"id":"going-further","title":"Going Further"}]}]},{"title":"The Client Generator Component","path":"client-generator","items":[{"id":"index","title":"The API Platform Client Generator","anchors":[{"id":"features","title":"Features"}]},{"id":"react","title":"React Generator","anchors":[{"id":"install","title":"Install"},{"id":"generating-a-progressive-web-app","title":"Generating a Progressive Web App"},{"id":"screenshots","title":"Screenshots"}]},{"id":"nextjs","title":"Next.js Generator","anchors":[{"id":"install","title":"Install","anchors":[{"id":"next--express-server","title":"Next + Express Server"},{"id":"installing-the-generator-dependencies","title":"Installing the Generator Dependencies"}]},{"id":"generating-routes","title":"Generating Routes"},{"id":"starting-the-project","title":"Starting the Project"},{"id":"screenshots","title":"Screenshots"}]},{"id":"react-native","title":"React Native generator","anchors":[{"id":"install","title":"Install"},{"id":"generating-a-native-app","title":"Generating a Native App"},{"id":"screenshots-in-ios-simulator","title":"Screenshots in iOS Simulator"}]},{"id":"vuejs","title":"Vue.js Generator"},{"id":"vuetify","title":"Vuetify Generator","anchors":[{"id":"install-with-docker","title":"Install with Docker"},{"id":"install-without-docker","title":"Install without Docker"},{"id":"generating-the-vuejs-web-app","title":"Generating the VueJS Web App"}]},{"id":"quasar","title":"Quasar Framework Generator"},{"id":"typescript","title":"TypeScript Interfaces","anchors":[{"id":"example","title":"Example"}]},{"id":"troubleshooting","title":"Troubleshooting"}]},{"title":"Deployment","path":"deployment","items":[{"id":"index","title":"Deploying API Platform Applications"},{"id":"kubernetes","title":"Deploying to a Kubernetes Cluster","anchors":[{"id":"preparing-your-cluster-and-your-local-machine","title":"Preparing Your Cluster and Your Local Machine"},{"id":"creating-and-publishing-the-docker-images","title":"Creating and Publishing the Docker Images"},{"id":"deploying","title":"Deploying"},{"id":"initializing-the-database","title":"Initializing the Database"},{"id":"tiller-rbac-issue","title":"Tiller RBAC Issue"}]},{"id":"docker-compose","title":"Deploying with Docker Compose","anchors":[{"id":"installing-the-docker-compose-setup-for-production","title":"Installing the Docker Compose Setup for Production"},{"id":"building-and-pushing-the-docker-images","title":"Building and Pushing the Docker Images"},{"id":"pulling-the-docker-images-and-running-the-services","title":"Pulling the Docker Images and Running the Services"}]},{"id":"heroku","title":"Deploying an API Platform App on Heroku"},{"id":"traefik","title":"Implement Træfik Into API Platform Dockerized","anchors":[{"id":"basic-implementation","title":"Basic Implementation"},{"id":"known-issues","title":"Known Issues"},{"id":"going-further","title":"Going Further"},{"id":"multiple-instances","title":"Multiple Instances"},{"id":"more-generic-approach","title":"More Generic Approach"}]}]},{"title":"General Information","path":"extra","items":[{"id":"philosophy","title":"API Platform's Philosophy"},{"id":"releases","title":"The Release Process"},{"id":"enterprise","title":"API Platform for Enterprise","anchors":[{"id":"enterprise-ready-open-source-softwaremanaged-for-you","title":"Enterprise-ready open source software—managed for you"}]},{"id":"security","title":"Security Policy","anchors":[{"id":"reporting-a-security-issue","title":"Reporting a Security Issue"},{"id":"resolving-process","title":"Resolving Process"},{"id":"security-updates-with-tidelift","title":"Security Updates With Tidelift"},{"id":"issue-severity","title":"Issue Severity","anchors":[{"id":"attack-complexity","title":"Attack Complexity"},{"id":"impact","title":"Impact"},{"id":"affected-projects","title":"Affected Projects"},{"id":"score-totals","title":"Score Totals"},{"id":"severity-levels","title":"Severity levels"}]},{"id":"credits","title":"Credits"}]},{"id":"troubleshooting","title":"Troubleshooting","anchors":[{"id":"using-docker","title":"Using Docker","anchors":[{"id":"with-docker-toolbox-on-windows","title":"With Docker Toolbox on Windows"},{"id":"error-starting-userland-proxy","title":"Error starting userland proxy"}]},{"id":"using-api-platform-and-jms-serializer-in-the-same-project","title":"Using API Platform and JMS Serializer in the same project"},{"id":"upstream-sent-too-big-header-while-reading-response-header-from-upstream-502-error","title":"\"upstream sent too big header while reading response header from upstream\" 502 Error"}]},{"id":"contribution-guides","title":"Contribution guides"},{"id":"conduct","title":"Contributor Code of Conduct","anchors":[{"id":"our-pledge","title":"Our Pledge"},{"id":"our-standards","title":"Our Standards"},{"id":"our-responsibilities","title":"Our Responsibilities"},{"id":"scope","title":"Scope"},{"id":"enforcement","title":"Enforcement"},{"id":"attribution","title":"Attribution"}]}]}]},"next":{},"prefixedVersion":"master","previous":{"slug":"/docs/master/deployment/heroku/","title":"Deploying an API Platform App on Heroku"},"title":"Implement Træfik Into API Platform Dockerized","urlEditDocumentation":"https://github.com/api-platform/docs/edit/master/deployment/traefik.md","version":"master/"}},"staticQueryHashes":["1552981879"]}